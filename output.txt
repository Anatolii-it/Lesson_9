SQL Server Analytical Toolkit: Using Windowing, Analytical, Ranking, and Aggregate